Version 4
SHEET 1 11460 3748
WIRE -896 -368 -960 -368
WIRE -720 -368 -816 -368
WIRE -560 -368 -720 -368
WIRE -432 -368 -560 -368
WIRE -560 -352 -560 -368
WIRE -128 -352 -272 -352
WIRE 128 -352 -48 -352
WIRE -720 -288 -720 -368
WIRE -432 -288 -432 -368
WIRE 3568 -288 3328 -288
WIRE 4272 -288 3568 -288
WIRE 4496 -288 4368 -288
WIRE 4592 -288 4496 -288
WIRE -560 -240 -560 -272
WIRE -560 -240 -656 -240
WIRE 848 -224 784 -224
WIRE 1152 -224 928 -224
WIRE -560 -208 -560 -240
WIRE 1152 -208 1152 -224
WIRE 1360 -208 1152 -208
WIRE 128 -192 128 -352
WIRE 4592 -176 4592 -288
WIRE -720 -160 -720 -192
WIRE -720 -160 -768 -160
WIRE -624 -160 -720 -160
WIRE 3328 -160 3328 -288
WIRE 1152 -128 1152 -208
WIRE 1360 -128 1360 -208
WIRE 3568 -128 3568 -288
WIRE 3648 -128 3568 -128
WIRE 3856 -128 3728 -128
WIRE 4176 -128 3856 -128
WIRE 4320 -128 4320 -224
WIRE 4320 -128 4176 -128
WIRE 1248 -112 1200 -112
WIRE 1312 -112 1248 -112
WIRE -960 -80 -960 -368
WIRE -768 -64 -768 -160
WIRE -272 -64 -272 -352
WIRE -560 -32 -560 -112
WIRE -560 -32 -704 -32
WIRE -432 -32 -432 -208
WIRE -432 -32 -560 -32
WIRE 3856 -32 3856 -128
WIRE 4592 -32 4592 -96
WIRE 128 -16 128 -112
WIRE 128 -16 -16 -16
WIRE 3328 -16 3328 -80
WIRE 1248 16 1248 -112
WIRE 1360 16 1360 -32
WIRE 1360 16 1248 16
WIRE 4176 32 4176 -128
WIRE -768 48 -768 16
WIRE -16 48 -16 -16
WIRE 4320 48 4320 -128
WIRE -704 64 -704 -32
WIRE 784 64 784 -224
WIRE 1152 80 1152 -32
WIRE 3856 80 3856 48
WIRE 4112 80 3856 80
WIRE 1360 96 1360 16
WIRE 3328 96 3328 64
WIRE -960 128 -960 0
WIRE -560 128 -560 -32
WIRE -272 144 -272 16
WIRE 128 144 128 -16
WIRE 3856 144 3856 80
WIRE -704 176 -704 144
WIRE -624 176 -704 176
WIRE -16 192 -16 128
WIRE 64 192 -16 192
WIRE -704 240 -704 176
WIRE -16 256 -16 192
WIRE 784 256 784 144
WIRE 1152 256 1152 160
WIRE 1152 256 784 256
WIRE 3856 256 3856 224
WIRE 4176 256 4176 128
WIRE 4320 256 4320 112
WIRE 784 272 784 256
WIRE 1152 272 1152 256
WIRE 1360 272 1360 176
WIRE 1360 272 1152 272
WIRE -704 352 -704 320
WIRE -560 352 -560 224
WIRE -16 368 -16 336
WIRE 128 368 128 240
WIRE 3568 384 3328 384
WIRE 4272 384 3568 384
WIRE 4592 384 4368 384
WIRE 4592 496 4592 384
WIRE 3328 512 3328 384
WIRE 3568 544 3568 384
WIRE 3648 544 3568 544
WIRE 3856 544 3728 544
WIRE 4176 544 3856 544
WIRE 4320 544 4320 448
WIRE 4320 544 4176 544
WIRE 3856 640 3856 544
WIRE 4592 640 4592 576
WIRE 3328 656 3328 592
WIRE 4176 704 4176 544
WIRE 4320 720 4320 544
WIRE 3856 752 3856 720
WIRE 4112 752 3856 752
WIRE 3328 768 3328 736
WIRE 3856 816 3856 752
WIRE 3856 928 3856 896
WIRE 4176 928 4176 800
WIRE 4320 928 4320 784
WIRE 3568 1056 3328 1056
WIRE 4272 1056 3568 1056
WIRE 4592 1056 4368 1056
WIRE 4592 1168 4592 1056
WIRE 3328 1184 3328 1056
WIRE 3568 1216 3568 1056
WIRE 3648 1216 3568 1216
WIRE 3856 1216 3728 1216
WIRE 4176 1216 3856 1216
WIRE 4320 1216 4320 1120
WIRE 4320 1216 4176 1216
WIRE 3856 1312 3856 1216
WIRE 4592 1312 4592 1248
WIRE 3328 1328 3328 1264
WIRE 4176 1376 4176 1216
WIRE 4320 1392 4320 1216
WIRE 3856 1424 3856 1392
WIRE 4112 1424 3856 1424
WIRE 3328 1440 3328 1408
WIRE 3856 1488 3856 1424
WIRE 3856 1600 3856 1568
WIRE 4176 1600 4176 1472
WIRE 4320 1600 4320 1456
WIRE 3600 1792 3360 1792
WIRE 4304 1792 3600 1792
WIRE 4576 1792 4400 1792
WIRE 4880 1792 4576 1792
WIRE 4880 1904 4880 1792
WIRE 3360 1920 3360 1792
WIRE 3600 1952 3600 1792
WIRE 3680 1952 3600 1952
WIRE 4176 1952 3760 1952
WIRE 4352 1952 4352 1856
WIRE 4352 1952 4176 1952
WIRE 4576 2016 4576 1792
WIRE 4880 2048 4880 1984
WIRE 3360 2064 3360 2000
WIRE 4176 2064 4176 1952
WIRE 4352 2128 4352 1952
WIRE 4576 2160 4576 2096
WIRE 4576 2160 4384 2160
WIRE 3360 2176 3360 2144
WIRE 4576 2192 4576 2160
WIRE 4352 2272 4352 2192
WIRE 4176 2288 4176 2128
WIRE 4576 2320 4576 2272
WIRE 4816 2496 4816 2480
WIRE 5568 2496 4816 2496
WIRE 5760 2496 5568 2496
WIRE 5936 2496 5760 2496
WIRE 3296 2512 3296 2496
WIRE 3856 2512 3296 2512
WIRE 4032 2512 3856 2512
WIRE 4192 2512 4032 2512
WIRE 4416 2512 4192 2512
WIRE 4192 2576 4192 2512
WIRE 3856 2592 3856 2512
WIRE 5568 2672 5568 2496
WIRE 4192 2688 4192 2640
WIRE 4816 2704 4816 2496
WIRE 3296 2720 3296 2512
WIRE 6112 2752 6112 2688
WIRE 4592 2768 4592 2704
WIRE 3856 2784 3856 2672
WIRE 4192 2832 4192 2768
WIRE 4192 2832 3920 2832
WIRE 4816 2848 4816 2784
WIRE 5936 2848 5936 2496
WIRE 3296 2864 3296 2800
WIRE 4416 2864 4416 2512
WIRE 5568 2960 5568 2752
WIRE 4192 2976 4192 2832
WIRE 5936 2992 5936 2928
WIRE 5936 2992 5600 2992
WIRE 4416 3008 4416 2944
WIRE 4416 3008 4224 3008
WIRE 5936 3024 5936 2992
WIRE 4416 3040 4416 3008
WIRE 5760 3072 5760 2496
WIRE 4032 3088 4032 2512
WIRE 5936 3136 5936 3104
WIRE 6112 3136 6112 2832
WIRE 6112 3136 5936 3136
WIRE 4192 3152 4192 3040
WIRE 4416 3152 4416 3120
WIRE 4416 3152 4192 3152
WIRE 4592 3152 4592 2848
WIRE 4592 3152 4416 3152
WIRE 5568 3184 5568 3024
WIRE 5936 3184 5936 3136
WIRE 4192 3200 4192 3152
WIRE 5760 3232 5760 3136
WIRE 5760 3232 5632 3232
WIRE 5872 3232 5760 3232
WIRE 3856 3248 3856 2880
WIRE 4032 3248 4032 3152
WIRE 4032 3248 3856 3248
WIRE 4128 3248 4032 3248
WIRE 5760 3296 5760 3232
WIRE 3856 3312 3856 3248
WIRE 4816 3424 4816 2928
WIRE 5568 3424 5568 3280
WIRE 5568 3424 4816 3424
WIRE 5760 3424 5760 3376
WIRE 5760 3424 5568 3424
WIRE 5936 3424 5936 3280
WIRE 5936 3424 5760 3424
WIRE 3296 3440 3296 2944
WIRE 3856 3440 3856 3392
WIRE 3856 3440 3296 3440
WIRE 4192 3440 4192 3296
WIRE 4192 3440 3856 3440
FLAG 128 368 0
FLAG -16 368 0
FLAG -272 144 0
FLAG -560 352 0
FLAG -704 352 0
FLAG -960 128 0
FLAG -768 48 0
FLAG 784 272 0
FLAG 4320 256 0
FLAG 4592 -32 0
FLAG 4496 -288 vout+
FLAG 3328 96 0
FLAG 4176 256 0
FLAG 3856 256 0
FLAG 4320 928 0
FLAG 4592 640 0
FLAG 3328 768 0
FLAG 4176 928 0
FLAG 3856 928 0
FLAG 4320 1600 0
FLAG 4592 1312 0
FLAG 3328 1440 0
FLAG 4176 1600 0
FLAG 3856 1600 0
FLAG 4176 2288 0
FLAG 4880 2048 0
FLAG 3360 2176 0
FLAG 4576 2320 0
FLAG 4352 2272 0
FLAG 3296 2496 0
FLAG 4592 2704 0
FLAG 4816 2480 0
FLAG 6112 2688 0
SYMBOL npn 64 144 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL res 0 144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 51k
SYMBOL res 0 352 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL voltage -272 -80 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {Vbat}
SYMBOL res -32 -368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL current 128 -192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 500µ
SYMBOL npn -624 128 R0
SYMATTR InstName Q6
SYMATTR Value 2N3904
SYMBOL res -688 160 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R12
SYMATTR Value 510k
SYMBOL res -688 336 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL voltage -960 -96 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {Vbat}
SYMBOL res -800 -384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL pnp -624 -112 M180
SYMATTR InstName Q7
SYMATTR Value 2N3906
SYMBOL pnp -656 -192 R180
SYMATTR InstName Q8
SYMATTR Value 2N3906
SYMBOL res -544 -256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL res -752 32 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R16
SYMATTR Value 100k
SYMBOL res -416 -192 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 100k
SYMBOL voltage 784 48 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {Vbat}
SYMBOL res 944 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL AO3401A 1120 -64 R180
SYMATTR InstName U1
SYMBOL AO3401A 1392 -64 M180
SYMATTR InstName U2
SYMBOL res 1136 64 R0
SYMATTR InstName R3
SYMATTR Value 100
SYMBOL current 1360 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I2
SYMATTR Value 1m
SYMBOL npn 4272 -224 R270
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL cap 4304 48 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res 3632 -112 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL voltage 3328 -176 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value {Vbat}
SYMBOL npn 4112 32 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res 3872 64 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 81k
SYMBOL res 3872 240 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R8
SYMATTR Value 22k
SYMBOL res 3312 -32 R0
SYMATTR InstName R19
SYMATTR Value 1m
SYMBOL npn 4272 448 R270
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res 4576 480 R0
SYMATTR InstName R2
SYMATTR Value 100
SYMBOL cap 4304 720 R0
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res 3632 560 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL voltage 3328 496 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value {Vbat}
SYMBOL npn 4112 704 R0
SYMATTR InstName Q4
SYMATTR Value 2N3904
SYMBOL res 3872 736 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 40k
SYMBOL res 3872 912 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res 3312 640 R0
SYMATTR InstName R21
SYMATTR Value 1m
SYMBOL npn 4272 1120 R270
SYMATTR InstName Q9
SYMATTR Value 2N3904
SYMBOL res 4576 1152 R0
SYMATTR InstName R22
SYMATTR Value 30
SYMBOL cap 4304 1392 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res 3632 1232 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL voltage 3328 1168 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value {Vbat}
SYMBOL npn 4112 1376 R0
SYMATTR InstName Q10
SYMATTR Value 2N3904
SYMBOL res 3872 1408 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R24
SYMATTR Value 40k
SYMBOL res 3872 1584 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R25
SYMATTR Value 10k
SYMBOL res 3312 1312 R0
SYMATTR InstName R26
SYMATTR Value 1m
SYMBOL current 4592 -176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I3
SYMATTR Value 6m
SYMBOL npn 4304 1856 R270
SYMATTR InstName Q11
SYMATTR Value 2N3904
SYMBOL res 4864 1888 R0
SYMATTR InstName R6
SYMATTR Value 30
SYMBOL cap 4160 2064 R0
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL res 3664 1968 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R27
SYMATTR Value 330
SYMBOL voltage 3360 1904 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value {Vbat}
SYMBOL res 4592 2112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R28
SYMATTR Value 1k
SYMBOL res 4592 2288 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R29
SYMATTR Value 10k
SYMBOL res 3344 2048 R0
SYMATTR InstName R30
SYMATTR Value 1m
SYMBOL ZZZ\\REF\\TL431 4368 2128 M0
SYMATTR InstName U3
SYMBOL res 4432 2960 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R31
SYMATTR Value 1k
SYMBOL res 4432 3136 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R32
SYMATTR Value 10k
SYMBOL ZZZ\\REF\\TL431 4208 2976 M0
SYMATTR InstName U4
SYMBOL res 3280 2848 R0
SYMATTR InstName R33
SYMATTR Value 1m
SYMBOL pnp 3920 2880 R180
SYMATTR InstName Q12
SYMATTR Value 2N5401
SYMBOL pnp 4128 3296 M180
SYMATTR InstName Q13
SYMATTR Value 2N5401
SYMBOL res 3840 3296 R0
SYMATTR InstName R34
SYMATTR Value 680
SYMBOL res 4176 2672 R0
SYMATTR InstName R35
SYMATTR Value 33
SYMBOL res 3840 2576 R0
SYMATTR InstName R36
SYMATTR Value 1
SYMBOL diode 4176 2576 R0
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res 4608 2864 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R37
SYMATTR Value 30
SYMBOL res 5952 2944 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R38
SYMATTR Value 1k
SYMBOL res 5952 3120 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R39
SYMATTR Value 10k
SYMBOL ZZZ\\REF\\TL431 5584 2960 M0
SYMATTR InstName U5
SYMBOL res 4800 2832 R0
SYMATTR InstName R40
SYMATTR Value 1m
SYMBOL pnp 5872 3280 M180
SYMATTR InstName Q15
SYMATTR Value 2N5401
SYMBOL res 5744 3280 R0
SYMATTR InstName R41
SYMATTR Value 680
SYMBOL res 5552 2656 R0
SYMATTR InstName R42
SYMATTR Value 1k
SYMBOL res 6128 2848 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R44
SYMATTR Value 30
SYMBOL pnp 5632 3280 R180
SYMATTR InstName Q14
SYMATTR Value 2N5401
SYMBOL cap 5744 3072 R0
SYMATTR InstName C5
SYMATTR Value 47µ
SYMBOL voltage 4816 2688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value PULSE({Vbat - ripple } {Vbat + ripple } 0 0 0 20u 40u)
SYMBOL cap 4016 3088 R0
SYMATTR InstName C6
SYMATTR Value 47µ
SYMBOL voltage 3296 2704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PULSE({Vbat - ripple } {Vbat + ripple } 0 0 0 20u 40u)
TEXT -1000 880 Left 2 !.param fsw = 40k
TEXT -1000 912 Left 2 !.param d = 0.5
TEXT -1000 848 Left 2 !.param Cf = 10u
TEXT -1000 944 Left 2 !.tran 10m
TEXT -1536 112 Left 2 !.lib AO3400.mod
TEXT -1184 528 Left 2 !.step param Vbat list 3.5 3.9 4.2
TEXT 5056 3312 Left 2 !.param ripple = 100m
